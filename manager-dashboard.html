<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>Manager Dashboard - Zayka-E-Jashn</title>
  <link rel="apple-touch-icon" sizes="180x180" href="apple-touch-icon.png">
<link rel="icon" type="image/png" sizes="32x32" href="favicon-32x32.png">
<link rel="icon" type="image/png" sizes="16x16" href="favicon-16x16.png">
<link rel="manifest" href="site.webmanifest">
<link rel="stylesheet" href="manager-dashboard.css">
</head>
<body>
</head>
<body>
  <div class="dashboard">
    <!-- Sidebar -->
    <div class="sidebar">
      <div class="logo">
        <h2>Zayka-E-Jashn</h2>
        <p>Manager Dashboard</p>
      </div>
      
      <div class="nav-menu">
        <div class="nav-item active" data-section="dashboard">
          <i>üìä</i> Dashboard
        </div>
        <div class="nav-item" data-section="menu">
          <i>üçΩÔ∏è</i> Menu Management
        </div>
        <div class="nav-item" data-section="orders">
          <i>üìù</i> Orders
        </div>
        <div class="nav-item" data-section="staff">
          <i>üë•</i> Staff
        </div>
        <div class="nav-item" data-section="reports">
          <i>üìà</i> Reports
        </div>
        <div class="nav-item" data-section="settings">
          <i>‚öôÔ∏è</i> Settings
        </div>
      </div>
    </div>
    
    <!-- Main Content -->
    <div class="main-content">
      <div class="header">
        <h2>Dashboard Overview</h2>
        <div class="user-info">
          <div class="user-avatar">M</div>
          <span>Manager</span>
        </div>
      </div>
      
       <!-- Settings Section -->
      <div class="settings-section">
        <div class="settings-tabs">
          <div class="settings-tab active" data-tab="profile">Profile</div>
          <div class="settings-tab" data-tab="security">Security</div>
          <div class="settings-tab" data-tab="notifications">Notifications</div>
          <div class="settings-tab" data-tab="restaurant">Restaurant</div>
        </div>
        
        <!-- Profile Settings -->
        <div class="settings-content active" id="profile-settings">
          <div class="profile-picture">
            <img src="https://via.placeholder.com/100" alt="Profile Picture" id="profile-img">
          </div>
          <div class="profile-picture-upload">
            <input type="file" id="profile-upload" accept="image/*" style="display: none;">
            <button class="btn btn-primary" onclick="document.getElementById('profile-upload').click()">Change Photo</button>
            <span>JPG or PNG no larger than 5MB</span>
          </div>
          
          <div class="form-group">
            <label for="name">Full Name</label>
            <input type="text" class="form-control" id="name" value="Manager">
          </div>
          
          <div class="form-group">
            <label for="email">Email</label>
            <input type="email" class="form-control" id="email" value="manager@zaykaejashn.com">
          </div>
          
          <div class="form-group">
            <label for="phone">Phone Number</label>
            <input type="tel" class="form-control" id="phone" value="+91 9876543210">
          </div>
          
          <button class="btn-save">Save Changes</button>
        </div>
        
        <!-- Security Settings -->
        <div class="settings-content" id="security-settings">
          <div class="form-group">
            <label for="current-password">Current Password</label>
            <input type="password" class="form-control" id="current-password">
          </div>
          
          <div class="form-group">
            <label for="new-password">New Password</label>
            <input type="password" class="form-control" id="new-password">
          </div>
          
          <div class="form-group">
            <label for="confirm-password">Confirm New Password</label>
            <input type="password" class="form-control" id="confirm-password">
          </div>
          
          <button class="btn-save">Update Password</button>
          
          <div style="margin-top: 30px;">
            <h4>Two-Factor Authentication</h4>
            <p>Add an extra layer of security to your account</p>
            <label class="switch">
              <input type="checkbox">
              <span class="slider"></span>
            </label>
          </div>
        </div>
        
        <!-- Notification Settings -->
        <div class="settings-content" id="notification-settings">
          <h4>Email Notifications</h4>
          
          <div class="notification-item">
            <div>
              <strong>New Orders</strong>
              <p>Get notified when new orders are placed</p>
            </div>
            <label class="switch">
              <input type="checkbox" checked>
              <span class="slider"></span>
            </label>
          </div>
          
          <div class="notification-item">
            <div>
              <strong>Order Updates</strong>
              <p>Get notified when order status changes</p>
            </div>
            <label class="switch">
              <input type="checkbox" checked>
              <span class="slider"></span>
            </label>
          </div>
          
          <div class="notification-item">
            <div>
              <strong>Special Offers</strong>
              <p>Receive promotional emails</p>
            </div>
            <label class="switch">
              <input type="checkbox">
              <span class="slider"></span>
            </label>
          </div>
          
          <h4 style="margin-top: 30px;">Push Notifications</h4>
          
          <div class="notification-item">
            <div>
              <strong>Urgent Orders</strong>
              <p>Get push notifications for urgent orders</p>
            </div>
            <label class="switch">
              <input type="checkbox" checked>
              <span class="slider"></span>
            </label>
          </div>
          
          <div class="notification-item">
            <div>
              <strong>System Alerts</strong>
              <p>Receive important system notifications</p>
            </div>
            <label class="switch">
              <input type="checkbox" checked>
              <span class="slider"></span>
            </label>
          </div>
        </div>
        
        <!-- Restaurant Settings -->
        <div class="settings-content" id="restaurant-settings">
          <div class="form-group">
            <label for="restaurant-name">Restaurant Name</label>
            <input type="text" class="form-control" id="restaurant-name" value="Zayka-E-Jashn">
          </div>
          
          <div class="form-group">
            <label for="restaurant-address">Address</label>
            <textarea class="form-control" id="restaurant-address" rows="3">123 Food Street, Mumbai, Maharashtra 400001</textarea>
          </div>
          
          <div class="form-group">
            <label for="restaurant-phone">Contact Number</label>
            <input type="tel" class="form-control" id="restaurant-phone" value="+91 22 12345678">
          </div>
          
          <div class="form-group">
            <label for="restaurant-email">Contact Email</label>
            <input type="email" class="form-control" id="restaurant-email" value="contact@zaykaejashn.com">
          </div>
          
          <div class="form-group">
            <label for="opening-hours">Opening Hours</label>
            <input type="text" class="form-control" id="opening-hours" value="10:00 AM - 11:00 PM">
          </div>
          
          <div class="form-group">
            <label for="delivery-radius">Delivery Radius (km)</label>
            <input type="number" class="form-control" id="delivery-radius" value="5" min="1" max="20">
          </div>
          
          <button class="btn-save">Save Restaurant Settings</button>
        </div>
      </div>
      <!-- Stats Cards -->
      <div class="cards">
        <div class="card">
          <div class="card-header">
            <div>
              <div class="card-title">Total Orders</div>
              <div class="card-value" id="order-count">0</div>
            </div>
            <div class="card-icon orders">üçΩÔ∏è</div>
          </div>
        </div>
        
        <div class="card">
          <div class="card-header">
            <div>
              <div class="card-title">Total Revenue</div>
              <div class="card-value" id="total-revenue">‚Çπ0</div>
            </div>
            <div class="card-icon revenue">üí∞</div>
          </div>
        </div>
        
        <div class="card">
          <div class="card-header">
            <div>
              <div class="card-title">Active Customers</div>
              <div class="card-value">18</div>
            </div>
            <div class="card-icon customers">üë•</div>
          </div>
        </div>
      </div>
      <div class="staff-section" style="display:none; background: white; border-radius: 10px; padding: 20px; box-shadow: 0 4px 6px rgba(0,0,0,0.1); margin-top: 30px;">
  <h3 class="section-title">Staff Members (Chefs)</h3>
  <table>
    <thead>
      <tr>
        <th>Name</th>
        <th>Email</th>
        <th>Phone</th>
        <th>Specialization</th>
        <th>Experience (years)</th>
      </tr>
    </thead>
    <tbody id="staff-table-body">
    </tbody>
  </table>
</div>
      <!-- Recent Orders -->
      <div class="recent-orders">
        <h3 class="section-title">Recent Orders</h3>
        <table>
          <thead>
            <tr>
              <th>Order ID</th>
              <th>Customer</th>
              <th>Items</th>
              <th>Amount</th>
              <th>Status</th>
              <th>Action</th>
            </tr>
          </thead>
          <tbody id="orders-table-body">
          </tbody>
        </table>
      </div>
    </div>
  </div>
  <script>
  async function fetchOrders() {
    try {
      const res = await fetch("http://localhost:3000/api/v1/orders/all", {
        headers: {
          "Content-Type": "application/json",
          "Authorization": "Bearer " + localStorage.getItem("token")
        }
      });

      const data = await res.json();
      const orders = data.orders || [];

      // Update Stats
      const orderCount = orders.length;
      let totalRevenue = 0;

      const tbody = document.getElementById("orders-table-body");
      tbody.innerHTML = "";

      orders.forEach(order => {
        const status = order.status
          ? order.status.charAt(0).toUpperCase() + order.status.slice(1).toLowerCase()
          : "Pending";
        const itemsCount = Array.isArray(order.item) ? order.item.length : 0;
        const amount = order.details?.amount || order.totalAmount || order.amount || 0;
        totalRevenue += parseFloat(amount);

        const row = document.createElement("tr");
        row.innerHTML = `
          <td>#${order._id}</td>
          <td>${order.customerName || "N/A"}</td>
          <td>${itemsCount}</td>
          <td>‚Çπ${amount}</td>
          <td><span class="status ${status.toLowerCase()}">${status}</span></td>
          <td><button class="btn btn-primary btn-sm">View</button></td>
        `;
        tbody.appendChild(row);
      });

      // Update dashboard cards
      document.getElementById("order-count").textContent = orderCount;
      document.getElementById("total-revenue").textContent = `‚Çπ${totalRevenue.toFixed(2)}`;
    } catch (error) {
      console.error("Error fetching orders:", error);
    }
  }

  async function fetchStaff() {
    try {
      const res = await fetch("http://localhost:3000/api/v1/chefs/all", {
        headers: {
          "Content-Type": "application/json",
          "Authorization": "Bearer " + localStorage.getItem("token")
        }
      });

      const data = await res.json();
      const tbody = document.getElementById("staff-table-body");
      tbody.innerHTML = "";

      if (data.success && data.chefs.length > 0) {
        data.chefs.forEach(chef => {
          const tr = document.createElement("tr");
          tr.innerHTML = `
            <td>${chef.name}</td>
            <td>${chef.email}</td>
            <td>${chef.phone}</td>
            <td>${chef.specialization}</td>
            <td>${chef.experience}</td>
          `;
          tbody.appendChild(tr);
        });
      } else {
        tbody.innerHTML = `<tr><td colspan="5">No staff found.</td></tr>`;
      }
    } catch (error) {
      console.error("Error fetching staff:", error);
    }
  }

  function capitalizeFirstLetter(string) {
    return string.charAt(0).toUpperCase() + string.slice(1);
  }

  document.querySelectorAll('.nav-item').forEach(item => {
    item.addEventListener('click', () => {
      // Remove active class from all nav items
      document.querySelectorAll('.nav-item').forEach(i => i.classList.remove('active'));
      item.classList.add('active');

      const section = item.dataset.section;
      const dashboardSections = document.querySelectorAll('.cards, .recent-orders, .header h2');
      const staffSection = document.querySelector('.staff-section');
      const settingsSection = document.querySelector('.settings-section');

      if (section === 'staff') {
        dashboardSections.forEach(el => el.style.display = 'none');
        staffSection.style.display = 'block';
        settingsSection.style.display = 'none';
        fetchStaff();
      } else if (section === 'orders') {
        dashboardSections.forEach(el => el.style.display = 'block');
        staffSection.style.display = 'none';
        settingsSection.style.display = 'none';
        document.querySelector('.header h2').textContent = 'Orders';
        fetchOrders();
      } else if (section === 'dashboard') {
        dashboardSections.forEach(el => el.style.display = 'block');
        staffSection.style.display = 'none';
        settingsSection.style.display = 'none';
        document.querySelector('.header h2').textContent = 'Dashboard Overview';
        fetchOrders();
      } else if (section === 'settings') {
        dashboardSections.forEach(el => el.style.display = 'none');
        staffSection.style.display = 'none';
        settingsSection.style.display = 'block';
        document.querySelector('.header h2').textContent = 'Settings';
      } else {
        dashboardSections.forEach(el => el.style.display = 'none');
        staffSection.style.display = 'none';
        settingsSection.style.display = 'none';
        document.querySelector('.header h2').textContent = capitalizeFirstLetter(section);
      }
    });
  });

  window.onload = () => {
    fetchOrders();
  };
  document.querySelectorAll('.settings-tab').forEach(tab => {
    tab.addEventListener('click', () => {
      // Remove active class from all tabs
      document.querySelectorAll('.settings-tab').forEach(t => t.classList.remove('active'));
      tab.classList.add('active');

      // Hide all settings-content sections
      document.querySelectorAll('.settings-content').forEach(c => c.classList.remove('active'));

      // Show the selected one
      const targetId = tab.dataset.tab + '-settings';
      document.getElementById(targetId).classList.add('active');
    });
  });
</script>

</body>
</html>